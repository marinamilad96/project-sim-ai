<?xml version='1.0' encoding='utf-8'?>
<beast version="2.0" namespace="beast.base.inference.parameter:beast.base.inference:remaster">
  <run spec="Simulator" nSims="1">
    <simulate spec="SimulatedTree" id="tree">
      <trajectory spec="StochasticTrajectory" id="traj">
        <population spec="RealParameter" id="S" value="10000 100000" dimension="2"/> <!-- test different initial values! -->
        <population spec="RealParameter" id="E" value="0 1"  dimension="2"/> <!-- From outside to Germany-->
        <population spec="RealParameter" id="I" value="0"  dimension="2"/>
        <samplePopulation spec="RealParameter" id="R" value="0"  dimension="2"/>
        <samplePopulation spec="RealParameter" id="sample" value="0" />
       
        <!-- SEIR reactions  Germany=0, outside=1 -->
        <plate var="i" range="0:1">
          <!-- Exposed to Infectious -->
          <reaction spec="Reaction" rate="0.083">
            E[$(i)]:1 -> I[$(i)]:1
          </reaction>
          <!-- Infectious to Recovered -->
          <reaction spec="Reaction" rate="0.0714">
            I[$(i)] -> R[$(i)]
          </reaction>
        </plate>

          <!-- Germany -->
          <reaction spec="Reaction" rate="0.698">
            S[0] + I[0]:1 -> I[0]:1 + E[0]:1
          </reaction>

          <reaction spec="Reaction" rate="0.03"> <!-- adjust sampling rate! -->
            I[0]:1 -> R[0] + sample[0]:1
          </reaction>


          <!-- Outside -->
          <reaction spec="Reaction" rate="0.00698"> <!-- mimic structured outside population by using lower infection rate, may need to be changed! -->
            S[1]:2 + I[1]:1 -> I[1]:1 + E[1]:1
          </reaction>

          <!-- migration from outside to Germany -->
          <reaction spec="Reaction" rate="0.01">  <!-- adjust migration rate!-->
            I[1]:1 -> I[0]:1
          </reaction>

          <!-- migration from Germany to outside -->
          <reaction spec="Reaction" rate="0.01">
            I[0]:1 -> I[1]:1
          </reaction>

        </trajectory>
      </simulate>

        <logger spec="Logger" fileName="$(filebase)-$(seed).traj">
            <log idref="traj"/>
        </logger>

        <logger spec="Logger" mode="tree" fileName="$(filebase).full.trees">
          <log spec="TypedTreeLogger">
            <tree spec="PrunedTree" samplePops="R" simulatedTree="@tree"/>
          </log>
        </logger>
        <logger spec="Logger" mode="tree" fileName="$(filebase).sampled.trees">
          <log spec="TypedTreeLogger">
            <tree spec="PrunedTree" samplePops="sample" simulatedTree="@tree"/>
          </log>
        </logger>

    </run>
  </beast>

